{% extends "base.html" %}

{% block title %}–ì–ª–∞–≤–Ω–∞—è - –ú–æ–∏ –°–∞–π—Ç—ã{% endblock %}

{% block content %}
<div class="page-header">
    <h1>–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã</h1>
</div>

<div id="groupsContainer" class="groups-container">
    {% for group in groups %}
    <div class="group-block" data-group-id="{{ group.id }}" data-order="{{ group.display_order }}">
        <div class="group-header">
            <div class="group-handle" style="display: none;">
                <span class="handle-icon">‚â°</span>
            </div>
            <div class="group-title">
                <h2>{{ group.name }}</h2>
                {% if group.description %}
                <p class="group-description">{{ group.description }}</p>
                {% endif %}
            </div>
            <div class="group-stats">
                <span class="site-count">{{ group.sites|length }} —Å–∞–π—Ç(–æ–≤)</span>
            </div>
        </div>

        {% if group.sites %}
        <div class="sites-grid">
            {% for site in group.sites %}
            <div class="site-card">
                <div class="site-icon">
                    {% if site.icon_url %}
                    <img src="{{ site.icon_url }}" alt="{{ site.name }}"
                         class="site-icon-img"
                         onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                    {% endif %}
                    <div class="default-icon" {% if site.icon_url %}style="display:none;"{% endif %}>
                        <span class="icon-placeholder">üåê</span>
                    </div>
                </div>
                <div class="site-content">
                    <h3 class="site-name">{{ site.name }}</h3>
                    {% if site.description %}
                    <p class="site-description">{{ site.description }}</p>
                    {% endif %}
                    <div class="site-actions">
                        <a href="{{ site.url }}" target="_blank" class="btn-visit">
                            <span class="btn-icon">‚Üó</span>
                            –ü–µ—Ä–µ–π—Ç–∏
                        </a>
                        {% if site.icon_url or site.description %}
                        <button type="button" class="btn-info"
                                data-toggle="modal" data-target="#siteInfoModal{{ site.id }}">
                            ‚ÑπÔ∏è –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                        </button>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="empty-group">
            <div class="empty-icon">üì≠</div>
            <p>–í —ç—Ç–æ–π –≥—Ä—É–ø–ø–µ –ø–æ–∫–∞ –Ω–µ—Ç —Å–∞–π—Ç–æ–≤</p>
            <a href="{{ url_for('admin_sites') }}" class="btn-add-sites">
                <span class="btn-icon">+</span> –î–æ–±–∞–≤–∏—Ç—å —Å–∞–π—Ç—ã
            </a>
        </div>
        {% endif %}
    </div>
    {% else %}
    <div class="no-groups">
        <div class="no-groups-icon">üìÇ</div>
        <h3>–ì—Ä—É–ø–ø—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
        <p>–ù–∞—á–Ω–∏—Ç–µ —Å —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä—É–ø–ø –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–∞–π—Ç–æ–≤ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏.</p>
        <a href="{{ url_for('admin_groups') }}" class="btn-admin">
            <span class="btn-icon">‚öôÔ∏è</span> –ü–µ—Ä–µ–π—Ç–∏ –≤ –∞–¥–º–∏–Ω–∫—É
        </a>
    </div>
    {% endfor %}
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –¥–ª—è —Å–∞–π—Ç–æ–≤ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π -->
{% for group in groups %}
    {% for site in group.sites %}
    <div class="modal fade" id="siteInfoModal{{ site.id }}" tabindex="-1">
        <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π -->
    </div>
    {% endfor %}
{% endfor %}
{% endblock %}